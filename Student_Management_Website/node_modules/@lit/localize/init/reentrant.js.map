{"version":3,"file":"reentrant.js","sourceRoot":"","sources":["../src/init/reentrant.ts"],"names":[],"mappings":"AAAA;;;;GAIG;AAEH,OAAO,EAAC,yBAAyB,EAAC,MAAM,oBAAoB,CAAC;AAC7D,OAAO,EAAC,UAAU,EAAC,MAAM,4BAA4B,CAAC;AAyCtD;;;;GAIG;AACH,MAAM,CAAC,MAAM,8BAA8B,GAIvC,CAAC,EACH,YAAY,EACZ,aAAa,EACb,SAAS,EACT,cAAc,GACS,EAAE,EAAE;IAC3B,MAAM,gBAAgB,GAAG,IAAI,GAAG,CAAC,aAAa,CAAC,CAAC;IAChD,yBAAyB,CAAC,CAAC,CAAC,QAAsB,EAAE,OAAoB,EAAE,EAAE;QAC1E,MAAM,MAAM,GAAG,SAAS,EAAE,CAAC;QAC3B,MAAM,SAAS,GACb,MAAM,KAAK,YAAY,IAAI,gBAAgB,CAAC,GAAG,CAAC,MAAM,CAAC;YACrD,CAAC,CAAC,cAAc,CAAC,MAAM,CAAC,EAAE,SAAS;YACnC,CAAC,CAAC,SAAS,CAAC;QAChB,OAAO,UAAU,CAAC,SAAS,EAAE,QAAQ,EAAE,OAAO,CAAC,CAAC;IAClD,CAAC,CAAU,CAAC,CAAC;IACb,OAAO,EAAE,CAAC;AACZ,CAAC,CAAC","sourcesContent":["/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\n\nimport {_installMsgImplementation} from '../lit-localize.js';\nimport {runtimeMsg} from '../internal/runtime-msg.js';\n\nimport type {\n  TemplateLike,\n  MsgFn,\n  LocaleModule,\n  MsgOptions,\n} from '../internal/types.js';\n\n/**\n * Configuration parameters for lit-localize when in reentrant mode.\n */\nexport interface ReentrantConfiguration {\n  /**\n   * Required locale code in which source templates in this project are written,\n   * and the active locale.\n   */\n  sourceLocale: string;\n\n  /**\n   * Required locale codes that are supported by this project. Should not\n   * include the `sourceLocale` code.\n   */\n  targetLocales: string[];\n\n  /**\n   * Required function that determines the currently active locale, called\n   * before every msg() call.\n   */\n  getLocale: () => string;\n\n  /**\n   * Required function that synchronously returns the localized templates for\n   * the given locale code.\n   *\n   * This function will only ever be called with a `locale` that is contained by\n   * `targetLocales`.\n   */\n  loadLocaleSync: (locale: string) => LocaleModule | undefined;\n}\n\n/**\n * Set configuration parameters for lit-localize when in reentrant mode.\n *\n * Throws if called more than once.\n */\nexport const configureReentrantLocalization: ((\n  config: ReentrantConfiguration\n) => {}) & {\n  _LIT_LOCALIZE_CONFIGURE_LOCALIZATION_?: never;\n} = ({\n  sourceLocale,\n  targetLocales,\n  getLocale,\n  loadLocaleSync,\n}: ReentrantConfiguration) => {\n  const targetLocalesSet = new Set(targetLocales);\n  _installMsgImplementation(((template: TemplateLike, options?: MsgOptions) => {\n    const locale = getLocale();\n    const templates =\n      locale !== sourceLocale && targetLocalesSet.has(locale)\n        ? loadLocaleSync(locale)?.templates\n        : undefined;\n    return runtimeMsg(templates, template, options);\n  }) as MsgFn);\n  return {};\n};\n"]}